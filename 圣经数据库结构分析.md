# 圣经数据库结构分析报告

## 数据库概述
- **数据库文件**: `bible.db`
- **数据库类型**: SQLite 3
- **版本信息**: B13 (2025年4月3日)
- **语言**: 和合本修订版

---

## 表结构详细说明

### 1. Bible 表（主经文表）
**用途**: 存储圣经的所有经文内容

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | INTEGER | 自增主键 | PRIMARY KEY |
| Book | INT | 书卷编号 (1-66) | NOT NULL |
| Chapter | INT | 章节号 | NOT NULL |
| Verse | INT | 节号 | NOT NULL |
| Scripture | TEXT | 经文内容 | NOT NULL |

- **记录总数**: 31,102 条
- **数据示例**:
  - 创世记 1:1 → "起初　神创造天地。"
  - 创世记 1:2 → "地是空虚混沌，渊面黑暗；　神的灵运行在水面上。"

**设计建议**:
- 使用 `(Book, Chapter, Verse)` 组合可以唯一定位一节经文
- 可建立组合索引以提高查询效率

---

### 2. Titles 表（标题表）
**用途**: 存储章节的小标题/段落标题

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | INTEGER | 自增主键 | PRIMARY KEY |
| Book | INT | 书卷编号 | NOT NULL |
| Chapter | INT | 章节号 | NOT NULL |
| Verse | INT | 标题起始节号 | NOT NULL |
| Scripture | TEXT | 标题内容 | NOT NULL |

- **记录总数**: 2,652 条
- **数据示例**:
  - 创世记 1:1 → "天地的创造"
  - 创世记 2:4 → "伊甸园"
  - 创世记 3:1 → "人违背命令"

**设计建议**:
- Verse 字段表示该标题对应的起始经文节号
- 用于在投影时显示段落标题，增强可读性

---

### 3. Chapters 表（整章内容表）
**用途**: 存储整章的压缩/编码内容

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | INTEGER | 自增主键 | PRIMARY KEY |
| Book | INT | 书卷编号 | NOT NULL |
| Chapter | INT | 章节号 | NOT NULL |
| Content | TEXT | 整章内容（Base64编码） | NOT NULL |

- **记录总数**: 1,189 条（圣经共1,189章）
- **数据特点**: Content 字段存储的是 Base64 编码后的压缩数据

**设计建议**:
- 此表可能用于批量导出或打印整章内容
- 对于投影功能，建议使用 Bible 表按节查询更灵活

---

### 4. metadata 表（元数据表）
**用途**: 存储数据库的元信息

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | INTEGER | 自增主键 | PRIMARY KEY |
| name | TEXT | 元数据键名 | NOT NULL |
| value | TEXT | 元数据值 | NOT NULL |

- **记录总数**: 8 条
- **重要元数据**:
  - `id`: B13 (圣经版本标识)
  - `date`: 20250403 (数据库创建日期)
  - `lang`: 和合本修订版 (中文版本)

---

### 5. Remark 表（备注表）
**用途**: 存储特定经文的注释或勘误信息

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | INTEGER | 自增主键 | PRIMARY KEY |
| Book | INT | 书卷编号 | NOT NULL |
| Chapter | INT | 章节号 | NOT NULL |
| Verse | INT | 节号 | NOT NULL |
| Key | TEXT | 备注关键词 | NOT NULL |
| Content | TEXT | 备注内容 | NOT NULL |

- **记录总数**: 10 条
- **数据示例**: 民数记 35:16-18 有关于印刷版本差异的勘误说明

---

## 圣经投影设计建议

### 核心查询需求

#### 1. **按书卷-章-节查询经文**
```sql
SELECT Scripture 
FROM Bible 
WHERE Book = ? AND Chapter = ? AND Verse = ?
```

#### 2. **查询整章经文**
```sql
SELECT Verse, Scripture 
FROM Bible 
WHERE Book = ? AND Chapter = ? 
ORDER BY Verse
```

#### 3. **查询章节标题**
```sql
SELECT Verse, Scripture 
FROM Titles 
WHERE Book = ? AND Chapter = ? 
ORDER BY Verse
```

#### 4. **组合查询（经文+标题）**
```sql
-- 获取带标题的整章内容
SELECT 
    'title' as type, t.Verse, t.Scripture
FROM Titles t
WHERE t.Book = ? AND t.Chapter = ?
UNION ALL
SELECT 
    'verse' as type, b.Verse, b.Scripture
FROM Bible b
WHERE b.Book = ? AND b.Chapter = ?
ORDER BY Verse
```

---

### 书卷编号对照表
需要创建一个书卷编号与名称的映射关系：

| 编号范围 | 类别 | 说明 |
|---------|------|------|
| 1-39 | 旧约 | 创世记(1) 到 玛拉基书(39) |
| 40-66 | 新约 | 马太福音(40) 到 启示录(66) |

建议创建一个书卷名称数组或配置文件。

---

### 投影界面设计要点

#### **功能模块**
1. **经文选择器**
   - 书卷下拉列表（中文名称）
   - 章节选择（动态加载该书卷的章数）
   - 节选择（可选择单节或连续多节）

2. **显示设置**
   - 字体大小调节
   - 背景颜色/图片
   - 是否显示标题
   - 是否显示书卷章节标注

3. **投影控制**
   - 上一节/下一节导航
   - 快速跳转
   - 分屏显示（控制端+投影端）

#### **性能优化**
- 可以预加载当前章节的所有经文到内存
- 建立 `(Book, Chapter)` 组合索引
- 对于频繁查询的书卷可以缓存

---

## 数据完整性检查

### 验证要点
- ✅ 总经文数 31,102 条（符合和合本圣经）
- ✅ 总章数 1,189 章
- ✅ 包含标题 2,652 个
- ✅ 元数据完整

### 建议的索引
```sql
CREATE INDEX idx_bible_book_chapter ON Bible(Book, Chapter);
CREATE INDEX idx_bible_book_chapter_verse ON Bible(Book, Chapter, Verse);
CREATE INDEX idx_titles_book_chapter ON Titles(Book, Chapter);
```

---

## 技术栈建议

### 前端开发
- **Electron** + **React**: 跨平台桌面应用
- **Vue.js** + **Electron**: 轻量级选择
- **Web 应用**: 使用 WebSQL/IndexedDB 缓存数据

### 后端/数据访问
- **Python**: sqlite3 模块（用于数据处理）
- **Node.js**: better-sqlite3 包（高性能）
- **C#**: System.Data.SQLite（Windows 桌面应用）

### 投影显示
- 使用第二显示器 API
- 支持全屏模式
- 考虑使用 WebSocket 实现控制端和投影端分离

---

## 附加功能建议

1. **搜索功能**: 全文搜索经文内容
2. **收藏夹**: 保存常用经文位置
3. **历史记录**: 记录最近浏览的经文
4. **并行对照**: 显示多个版本对照
5. **导出功能**: 导出为 PDF/Word
6. **自定义模板**: 保存不同的投影样式

---

## 总结

这个圣经数据库设计良好，结构清晰：
- ✅ **Bible 表** 是核心，包含所有经文
- ✅ **Titles 表** 提供段落标题，提升阅读体验
- ✅ **Chapters 表** 提供整章数据备份
- ✅ **metadata 表** 记录版本信息
- ✅ **Remark 表** 提供勘误和注释

**推荐的投影应用架构**:
```
[数据层] SQLite Database (bible.db)
    ↓
[业务逻辑层] 经文查询服务 + 书卷管理
    ↓
[界面层] 控制界面 + 投影界面
```

祝您的圣经投影应用开发顺利！🙏

